#! /bin/sh /usr/share/dpatch/dpatch-run
##
## All lines beginning with `## DP:' are a description of the patch.
## DP: http://svn.apache.org/viewvc?view=revision&revision=1167158

@DPATCH@
diff -urNad '--exclude=CVS' '--exclude=.svn' '--exclude=.git' '--exclude=.arch' '--exclude=.hg' '--exclude=_darcs' '--exclude=.bzr' squeeze-apache2~/modules/proxy/mod_proxy_ajp.c squeeze-apache2/modules/proxy/mod_proxy_ajp.c
--- squeeze-apache2~/modules/proxy/mod_proxy_ajp.c	2010-07-12 08:57:41.000000000 +0200
+++ squeeze-apache2/modules/proxy/mod_proxy_ajp.c	2011-09-25 23:57:45.734225690 +0200
@@ -213,7 +213,9 @@
                      conn->worker->hostname);
         if (status == AJP_EOVERFLOW)
             return HTTP_BAD_REQUEST;
-        else {
+        else if  (status == AJP_EBAD_METHOD) {
+            return HTTP_NOT_IMPLEMENTED;
+        } else {
             /*
              * This is only non fatal when the method is idempotent. In this
              * case we can dare to retry it with a different worker if we are
