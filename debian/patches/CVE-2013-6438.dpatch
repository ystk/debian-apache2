#! /bin/sh /usr/share/dpatch/dpatch-run
# Description: fix denial of service via mod_dav incorrect end of string
#  calculation
# Origin: upstream, http://svn.apache.org/viewvc?view=revision&revision=1576706

@DPATCH@
diff -urNad '--exclude=CVS' '--exclude=.svn' '--exclude=.git' '--exclude=.arch' '--exclude=.hg' '--exclude=_darcs' '--exclude=.bzr' apache2-2.2.14~/modules/dav/main/util.c apache2-2.2.14/modules/dav/main/util.c
--- apache2-2.2.14~/modules/dav/main/util.c	2014-03-19 15:43:39.000000000 -0400
+++ apache2-2.2.14/modules/dav/main/util.c	2014-03-19 15:43:54.743892212 -0400
@@ -372,8 +372,10 @@
 
     if (strip_white) {
         /* trim leading whitespace */
-        while (apr_isspace(*cdata))     /* assume: return false for '\0' */
+        while (apr_isspace(*cdata)) {     /* assume: return false for '\0' */
             ++cdata;
+            --len;
+        }
 
         /* trim trailing whitespace */
         while (len-- > 0 && apr_isspace(cdata[len]))
