Origin: https://github.com/apache/httpd/commit/fa7b2a5250e54363b3a6c8ac3aaa7de4e8da9b2e
Reviewed-by: Sylvain Beucler <beuc@debian.org>
Last-Update: 2021-09-24

From fa7b2a5250e54363b3a6c8ac3aaa7de4e8da9b2e Mon Sep 17 00:00:00 2001
From: Yann Ylavic <ylavic@apache.org>
Date: Tue, 7 Sep 2021 16:05:31 +0000
Subject: [PATCH] Merge r1878092 from trunk:

Fix a NULL pointer dereference

* server/scoreboard.c (ap_increment_counts): In certain cases like certain
  invalid requests r->method might be NULL here. r->method_number defaults
  to M_GET and hence is M_GET in these cases.

Submitted by: rpluem
Reviewed by: covener, ylavic, jfclere


git-svn-id: https://svn.apache.org/repos/asf/httpd/httpd/branches/2.4.x@1893051 13f79535-47bb-0310-9956-ffa450edef68
---
 server/scoreboard.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

Index: apache2-2.4.10/server/scoreboard.c
===================================================================
--- apache2-2.4.10.orig/server/scoreboard.c
+++ apache2-2.4.10/server/scoreboard.c
@@ -368,7 +368,7 @@ AP_DECLARE(void) ap_increment_counts(ap_
     if (pfn_ap_logio_get_last_bytes != NULL) {
         bytes = pfn_ap_logio_get_last_bytes(r->connection);
     }
-    else if (r->method_number == M_GET && r->method[0] == 'H') {
+    else if (r->method_number == M_GET && r->method && r->method[0] == 'H') {
         bytes = 0;
     }
     else {
